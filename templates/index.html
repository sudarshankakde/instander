{% extends "base_template.html" %}
{% block hero %}
<!-- Hero Section -->
<section class="py-12 md:py-20 bg-gradient-to-br from-primary-50 via-purple-50 to-pink-50 dark:from-gray-800 dark:via-gray-900 dark:to-gray-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 dark:text-white mb-6">
            Download Instagram <span class="bg-gradient-to-r from-instagram-pink to-instagram-purple bg-clip-text text-transparent">Content</span>
        </h1>
        <p class="text-lg md:text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto mb-10">
            Save your favorite Instagram stories, reels, and posts quickly and easily with our free downloader tool.
        </p>

        <!-- AdSense Placeholder -->
        <div class="max-w-2xl mx-auto mb-8">
            <div class="bg-gray-100 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center">
                <p class="text-sm text-gray-500 dark:text-gray-400">Advertisement</p>
                <div class="h-20 flex items-center justify-center">
                    <span class="text-gray-400 dark:text-gray-500">728x90 Banner Ad</span>
                </div>
            </div>
        </div>

        <!-- Download Form -->
        <div class="max-w-2xl mx-auto bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8 border border-gray-200 dark:border-gray-700">
            <div class="tab-container mb-6">
                <div class="flex border-b border-gray-200 dark:border-gray-700">
                    <!-- Tabs -->
                    <!-- (unchanged tab buttons) -->
                    <!-- Reels Tab -->
                    <button class="tab-button active py-3 px-6 border-b-2 border-primary-500 text-primary-600 dark:text-primary-400 font-medium transition-all duration-200" data-tab="reels">
                        <svg class="w-5 h-5 inline-block mr-2" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                        Reels
                    </button>

                    <!-- Posts Tab -->
                    <button class="tab-button py-3 px-6 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 font-medium transition-all duration-200" data-tab="posts">
                        <svg class="w-5 h-5 inline-block mr-2" fill="currentColor" viewBox="0 0 24 24">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none"/>
                            <circle cx="8.5" cy="8.5" r="1.5"/>
                            <polyline points="21,15 16,10 5,21"/>
                        </svg>
                        Posts
                    </button>

                    <!-- Facebook Video Tab (Previously Stories) -->
                    <button class="tab-button py-3 px-6 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 flex flex-row items-center justify-center gap-3 font-medium transition-all duration-200" data-tab="facebook">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-facebook" viewBox="0 0 16 16">
  <path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951"/>
</svg>
                        Facebook Video
                    </button>
                
                </div>
            </div>

            <!-- Reels Tab -->
            <div id="reels-tab" class="tab-content">
                <form hx-post="/download/reels/" hx-target="#download-response-reels" hx-swap="innerHTML">
                    <div class="mb-6">
                        <div class="bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4 mb-4">
                            <h3 class="font-medium text-purple-900 dark:text-purple-100 mb-2">ðŸŽ¬ How to Download Reels:</h3>
                            <ol class="text-sm text-purple-800 dark:text-purple-200 space-y-1">
                                <li>1. Go to Instagram and find the reel you want</li>
                                <li>2. Tap the share button and copy the link</li>
                                <li>3. Paste the URL in the field below</li>
                                <li>4. Click "Download Reel" to save the video</li>
                            </ol>
                        </div>
                        <label for="reels-url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Paste Instagram Reel URL</label>
                        <input type="text" id="reels-url" name="url" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white transition-all duration-200" placeholder="https://www.instagram.com/reel/...">
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-medium py-3 px-4 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transform hover:scale-105">
                        Download Reel
                    </button>
                </form>
                
                <!-- HTMX Response Target -->
            <div id="download-response-reels" class="mt-6 text-left"></div>
            </div>

            <!-- Posts Tab -->
            <div id="posts-tab" class="tab-content hidden">
                <form hx-post="/download/posts/" hx-target="#download-response-post" hx-swap="innerHTML">
                    <div class="mb-6">
                        <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 mb-4">
                            <h3 class="font-medium text-green-900 dark:text-green-100 mb-2">ðŸ“¸ How to Download Posts:</h3>
                            <ol class="text-sm text-green-800 dark:text-green-200 space-y-1">
                                <li>1. Find the Instagram post you want to download</li>
                                <li>2. Copy the post URL from your browser or app</li>
                                <li>3. Paste the URL in the field below</li>
                                <li>4. Click "Download Post" to save photos/videos</li>
                            </ol>
                        </div>
                        <label for="posts-url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Paste Instagram Post URL</label>
                        <input type="text" id="posts-url" name="url" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white transition-all duration-200" placeholder="https://www.instagram.com/p/...">
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700 text-white font-medium py-3 px-4 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transform hover:scale-105">
                        Download Post
                    </button>
                </form>
            <div id="download-response-posts" class="mt-6 text-left"></div>
            </div>

            <!-- Facebook Tab -->
            <div id="facebook-tab" class="tab-content hidden">
                <form hx-post="/download/facebook/" hx-target="#download-response-facebook" hx-swap="innerHTML">
                    <div class="mb-6">
                        <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-4">
                            <h3 class="font-medium text-blue-900 dark:text-blue-100 mb-2">ðŸ“º How to Download Facebook Videos:</h3>
                            <ol class="text-sm text-blue-800 dark:text-blue-200 space-y-1">
                                <li>1. Go to the Facebook video you want</li>
                                <li>2. Click the "Share" button and copy the video link</li>
                                <li>3. Paste the link below</li>
                                <li>4. Click "Download Video"</li>
                            </ol>
                        </div>
                        <label for="facebook-url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Paste Facebook Video URL</label>
                        <input type="text" id="facebook-url" name="url" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white transition-all duration-200" placeholder="https://www.facebook.com/...">
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-medium py-3 px-4 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transform hover:scale-105">
                        Download Video
                    </button>
                </form>
                <div id="download-response-facebook" class="mt-6 text-left"></div>
            </div>

            
        </div>
    </div>
</section>
{% endblock hero %}
{% block content %}

    <!-- AdSense Placeholder - Rectangle -->
    <section class="py-8 bg-white dark:bg-gray-800">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div
          class="bg-gray-100 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6"
        >
          <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">
            Advertisement
          </p>
          <div class="h-32 flex items-center justify-center">
            <span class="text-gray-400 dark:text-gray-500"
              >336x280 Rectangle Ad</span
            >
          </div>
        </div>
      </div>
    </section>

    <!-- How to Use Section -->
    <section class="py-12 bg-gray-50 dark:bg-gray-900">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2
          class="text-3xl font-bold text-center text-gray-900 dark:text-white mb-12"
        >
          How to Use InstaSave
        </h2>

        <div class="grid md:grid-cols-4 gap-8">
          <div class="text-center">
            <div
              class="bg-gradient-to-br from-primary-100 to-primary-200 dark:from-primary-900 dark:to-primary-800 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4 shadow-lg"
            >
              <span
                class="text-primary-600 dark:text-primary-400 text-2xl font-bold"
                >1</span
              >
            </div>
            <h3 class="text-xl font-medium text-gray-900 dark:text-white mb-2">
              Choose Content Type
            </h3>
            <p class="text-gray-600 dark:text-gray-300">
              Select whether you want to download Stories, Reels, or Posts
            </p>
          </div>

          <div class="text-center">
            <div
              class="bg-gradient-to-br from-purple-100 to-purple-200 dark:from-purple-900 dark:to-purple-800 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4 shadow-lg"
            >
              <span
                class="text-purple-600 dark:text-purple-400 text-2xl font-bold"
                >2</span
              >
            </div>
            <h3 class="text-xl font-medium text-gray-900 dark:text-white mb-2">
              Copy URL/Username
            </h3>
            <p class="text-gray-600 dark:text-gray-300">
              Copy the Instagram URL or enter the username as required
            </p>
          </div>

          <div class="text-center">
            <div
              class="bg-gradient-to-br from-green-100 to-green-200 dark:from-green-900 dark:to-green-800 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4 shadow-lg"
            >
              <span
                class="text-green-600 dark:text-green-400 text-2xl font-bold"
                >3</span
              >
            </div>
            <h3 class="text-xl font-medium text-gray-900 dark:text-white mb-2">
              Paste & Process
            </h3>
            <p class="text-gray-600 dark:text-gray-300">
              Paste the URL or username and click the download button
            </p>
          </div>

          <div class="text-center">
            <div
              class="bg-gradient-to-br from-pink-100 to-pink-200 dark:from-pink-900 dark:to-pink-800 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4 shadow-lg"
            >
              <span class="text-pink-600 dark:text-pink-400 text-2xl font-bold"
                >4</span
              >
            </div>
            <h3 class="text-xl font-medium text-gray-900 dark:text-white mb-2">
              Download & Save
            </h3>
            <p class="text-gray-600 dark:text-gray-300">
              Click the download button to save the content to your device
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- AdSense Placeholder - Leaderboard -->
    <section class="py-8 bg-white dark:bg-gray-800">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div
          class="bg-gray-100 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4"
        >
          <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">
            Advertisement
          </p>
          <div class="h-24 flex items-center justify-center">
            <span class="text-gray-400 dark:text-gray-500"
              >728x90 Leaderboard Ad</span
            >
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ Section -->
    <section class="py-12 bg-gray-50 dark:bg-gray-900">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2
          class="text-3xl font-bold text-center text-gray-900 dark:text-white mb-12"
        >
          Questions & Answers
        </h2>

        <div class="max-w-4xl mx-auto grid md:grid-cols-2 gap-6">
          <div
            class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700"
          >
            <h3
              class="text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center"
            >
              <span
                class="bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-400 rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold mr-3"
                >?</span
              >
              Is InstaSave free to use?
            </h3>
            <p class="text-gray-600 dark:text-gray-300">
              Yes, InstaSave is completely free to use. You can download
              Instagram reels, posts and Facebook videos without any cost or
              registration.
            </p>
          </div>

          <div
            class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700"
          >
            <h3
              class="text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center"
            >
              <span
                class="bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-400 rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold mr-3"
                >?</span
              >
              Is it legal to download Instagram content?
            </h3>
            <p class="text-gray-600 dark:text-gray-300">
              InstaSave is designed for personal use only. Please respect
              copyright laws and Instagram's Terms of Service. Only download
              content for personal viewing.
            </p>
          </div>

          <div
            class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700"
          >
            <h3
              class="text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center"
            >
              <span
                class="bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-400 rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold mr-3"
                >?</span
              >
              Can I download private content?
            </h3>
            <p class="text-gray-600 dark:text-gray-300">
              No, InstaSave only works with public Instagram content. Private
              profiles and content are not accessible through our tool for
              privacy protection.
            </p>
          </div>

          <div
            class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700"
          >
            <h3
              class="text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center"
            >
              <span
                class="bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-400 rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold mr-3"
                >?</span
              >
              What devices are supported?
            </h3>
            <p class="text-gray-600 dark:text-gray-300">
              InstaSave works on all devices including desktop computers,
              laptops, tablets, and mobile phones with a modern web browser.
            </p>
          </div>

          <div
            class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700"
          >
            <h3
              class="text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center"
            >
              <span
                class="bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-400 rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold mr-3"
                >?</span
              >
              Do I need to create an account?
            </h3>
            <p class="text-gray-600 dark:text-gray-300">
              No account creation required! Simply paste the URL and download
              your content instantly without any registration process.
            </p>
          </div>

          <div
            class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700"
          >
            <h3
              class="text-lg font-medium text-gray-900 dark:text-white mb-3 flex items-center"
            >
              <span
                class="bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-400 rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold mr-3"
                >?</span
              >
              What quality are downloads?
            </h3>
            <p class="text-gray-600 dark:text-gray-300">
              We provide downloads in the highest quality available from
              Instagram, maintaining the original resolution and quality of the
              content.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- AdSense Placeholder - Sidebar -->
    <section class="py-8 bg-white dark:bg-gray-800">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-center">
          <div
            class="bg-gray-100 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center"
          >
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">
              Advertisement
            </p>
            <div class="w-64 h-32 flex items-center justify-center">
              <span class="text-gray-400 dark:text-gray-500"
                >300x250 Medium Rectangle</span
              >
            </div>
          </div>
        </div>
      </div>
    </section>

{% endblock content %}
{% block script %}
 <!-- JavaScript -->
    <script>
       
        
        // Tab Switching
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons
                tabButtons.forEach(btn => {
                    btn.classList.remove('active', 'border-primary-500', 'text-primary-600', 'dark:text-primary-400');
                    btn.classList.add('border-transparent', 'text-gray-500', 'dark:text-gray-400');
                });
                
                // Add active class to clicked button
                button.classList.add('active', 'border-primary-500', 'text-primary-600', 'dark:text-primary-400');
                button.classList.remove('border-transparent', 'text-gray-500', 'dark:text-gray-400');
                
                // Hide all tab contents
                tabContents.forEach(content => {
                    content.classList.add('hidden');
                });
                
                // Show selected tab content
                const tabId = button.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.remove('hidden');
            });
        });
        
        // Download functionality with SweetAlert2
        const downloadStoriesBtn = document.getElementById('download-stories');
        const downloadReelsBtn = document.getElementById('download-reels');
        const downloadPostsBtn = document.getElementById('download-posts');
        const resultDiv = document.getElementById('result');
        const previewImage = document.getElementById('preview-image');
        const contentTitle = document.getElementById('content-title');
        const contentAuthor = document.getElementById('content-author');
        const contentType = document.getElementById('content-type');
        const downloadLink = document.getElementById('download-link');
        
        // Stories download
        downloadStoriesBtn.addEventListener('click', async () => {
            const username = document.getElementById('stories-username').value.trim();
            if (!username) {
                Swal.fire({
                    icon: 'error',
                    title: 'Username Required',
                    text: 'Please enter a valid Instagram username',
                    ...getSweetAlertTheme()
                });
                return;
            }
            
            // Show loading
            Swal.fire({
                title: 'Processing...',
                text: 'Fetching stories for @' + username,
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                },
                ...getSweetAlertTheme()
            });
            
            // Simulate API call
            setTimeout(() => {
                Swal.close();
                previewImage.src = '/placeholder.svg?height=200&width=200';
                contentTitle.textContent = 'Instagram Story';
                contentAuthor.textContent = '@' + username;
                contentType.textContent = 'Story';
                downloadLink.href = '#';
                resultDiv.classList.remove('hidden');
                
                Swal.fire({
                    icon: 'success',
                    title: 'Stories Found!',
                    text: 'Stories are ready for download',
                    ...getSweetAlertTheme()
                });
            }, 2000);
        });
        
        // Reels download
        downloadReelsBtn.addEventListener('click', async () => {
            const url = document.getElementById('reels-url').value.trim();
            if (!url || !url.includes('instagram.com/reel/')) {
                Swal.fire({
                    icon: 'error',
                    title: 'Invalid URL',
                    text: 'Please enter a valid Instagram reel URL',
                    ...getSweetAlertTheme()
                });
                return;
            }
            
            // Show loading
            Swal.fire({
                title: 'Processing...',
                text: 'Downloading your reel...',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                },
                ...getSweetAlertTheme()
            });
            
            // Simulate API call
            setTimeout(() => {
                Swal.close();
                previewImage.src = '/placeholder.svg?height=200&width=200';
                contentTitle.textContent = 'Instagram Reel';
                contentAuthor.textContent = '@instagram_user';
                contentType.textContent = 'Reel';
                downloadLink.href = '#';
                resultDiv.classList.remove('hidden');
                
                Swal.fire({
                    icon: 'success',
                    title: 'Reel Ready!',
                    text: 'Your reel is ready for download',
                    ...getSweetAlertTheme()
                });
            }, 2000);
        });
        
        // Posts download
        downloadPostsBtn.addEventListener('click', async () => {
            const url = document.getElementById('posts-url').value.trim();
            if (!url || !url.includes('instagram.com/p/')) {
                Swal.fire({
                    icon: 'error',
                    title: 'Invalid URL',
                    text: 'Please enter a valid Instagram post URL',
                    ...getSweetAlertTheme()
                });
                return;
            }
            
            // Show loading
            Swal.fire({
                title: 'Processing...',
                text: 'Downloading your post...',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                },
                ...getSweetAlertTheme()
            });
            
            // Simulate API call
            setTimeout(() => {
                Swal.close();
                previewImage.src = '/placeholder.svg?height=200&width=200';
                contentTitle.textContent = 'Instagram Post';
                contentAuthor.textContent = '@instagram_user';
                contentType.textContent = 'Post';
                downloadLink.href = '#';
                resultDiv.classList.remove('hidden');
                
                Swal.fire({
                    icon: 'success',
                    title: 'Post Ready!',
                    text: 'Your post is ready for download',
                    ...getSweetAlertTheme()
                });
            }, 2000);
        });
    </script>
{% comment %} htmx loader {% endcomment %}
    <script>
        // Create and insert the loader HTML
  const loader = document.createElement('div');
  loader.id = 'global-htmx-loader';
  loader.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden';
  loader.innerHTML = `
    <div class="bg-white dark:bg-gray-900 p-6 rounded-xl shadow-lg flex flex-col items-center gap-4">
      <svg class="animate-spin h-10 w-10 text-purple-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
      </svg>
      <p class="text-sm text-gray-700 dark:text-gray-300 font-medium">Processing your download...</p>
    </div>
  `;
  document.body.appendChild(loader);

  // Show loader before request
  document.body.addEventListener('htmx:beforeRequest', function () {
    loader.classList.remove('hidden');
  });

  // Hide loader after content is swapped in
  document.body.addEventListener('htmx:afterSwap', function () {
    loader.classList.add('hidden');
  });

  // Also hide on error or abort
  document.body.addEventListener('htmx:responseError', function () {
    loader.classList.add('hidden');
  });
  document.body.addEventListener('htmx:afterRequest', function () {
    loader.classList.add('hidden');
  });
    </script>
{% endblock script %}